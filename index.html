<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Liste de No√´l ‚Äì Pierre, Nathalya, Toffee & Topito üê∂üêæ</title>

<!-- Police -->
<link href="https://fonts.googleapis.com/css2?family=GreatVibes&display=swap" rel="stylesheet">

<style>
    body {
        font-family: "Segoe UI", Arial, sans-serif;
        background: linear-gradient(#fff8f8, #ffecec);
        margin: 0;
        padding: 20px;
        overflow-x: hidden;
    }

    #site-wrapper {
        max-width: 1100px;
        margin: auto;
        padding: 20px 30px;
        border: 5px solid #d6b669;
        border-radius: 20px;
        background: #ffffffcc;
        box-shadow: 0 0 25px rgba(180,140,60,0.35);
        backdrop-filter: blur(4px);
    }

    nav {
        text-align: center;
        margin-bottom: 20px;
    }
    nav button {
        padding: 10px 20px;
        font-size: 18px;
        border-radius: 10px;
        border: 2px solid #b3001b;
        margin: 5px;
        background: #fff3f3;
        cursor: pointer;
    }
    nav button:hover {
        background: #ffdede;
    }

    #modeToggle {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 10px 18px;
        background: #b3001b;
        color: white;
        border: 2px solid #ddc98c;
        border-radius: 30px;
        cursor: pointer;
        font-weight: bold;
        z-index: 999;
    }
    body.night {
        background: linear-gradient(#111, #000);
        color: #eee;
    }

    h1 {
        text-align: center;
        font-size: 48px;
        color: #b3001b;
        font-family: "GreatVibes", cursive;
        padding: 20px;
        border: 4px solid #d6b669;
        border-radius: 20px;
        background: linear-gradient(white, #fff5f5);
        display: inline-block;
    }

    #countdown {
        text-align: center;
        color: #b3001b;
        font-size: 24px;
        margin-bottom: 20px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        border: 2px solid #ddc98c;
        background: white;
    }

    th {
        background: linear-gradient(#b3001b, #8b0000);
        color: white;
        padding: 14px;
        font-size: 17px;
    }

    td {
        border-bottom: 1px solid #f0d5d5;
        padding: 12px;
    }

    tr.selected {
        background: #38b000 !important;
        color: white !important;
        text-decoration: line-through;
        font-weight: bold;
        box-shadow: inset 0 0 18px rgba(255,255,255,0.7);
        animation: sparkle 1s ease-out;
    }

    @keyframes sparkle {
        0% { box-shadow: 0 0 20px #fff; }
        100% { box-shadow: inset 0 0 18px rgba(255,255,255,0.7); }
    }

    .linkInput {
        width: 92%;
        padding: 6px;
        border: 1px solid #b3001b;
        border-radius: 5px;
    }

    .editLinkBtn {
        margin-left: 5px;
        padding: 4px 7px;
        font-size: 12px;
        cursor: pointer;
        border-radius: 6px;
        border: 1px solid #b3001b;
        background: #fff0f0;
    }

    .kdo-link {
        color: #0044cc;
        font-weight: bold;
        text-decoration: underline;
    }

    #addRowBtn {
        margin: 0 auto 25px auto;
        display: block;
        padding: 12px 25px;
        background: linear-gradient(#b3001b, #8b0000);
        border: none;
        color: white;
        font-size: 20px;
        border-radius: 10px;
        cursor: pointer;
    }

    /* Neige */
    .flake {
        position: fixed;
        top: -10px;
        color: white;
        text-shadow: 0 0 5px #fff;
        animation: fall linear infinite;
        opacity: 0.9;
        pointer-events: none;
    }
    @keyframes fall { to { transform: translateY(105vh); opacity: 0.3; }}

    #tree {
        position: fixed;
        bottom: 10px;
        left: 10px;
        font-size: 55px;
        animation: sway 2.8s infinite;
    }
    @keyframes sway {
        0% { transform: rotate(-3deg); }
        50% { transform: rotate(3deg); }
        100% { transform: rotate(-3deg); }
    }

    /* CALENDRIER */
    #calendrier {
        display: none;
        margin-top: 20px;
        text-align: center;
    }

    .calendrier-grid {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 15px;
        padding: 20px;
    }

    .day {
        background: white;
        padding: 10px;
        border-radius: 10px;
        cursor: pointer;
        box-shadow: 0 0 12px #0003;
        transition: transform .2s;
        position: relative;
    }
    .day.locked {
        filter: grayscale(1);
        opacity: 0.5;
        cursor: not-allowed;
    }
    .day:hover:not(.locked) { transform: scale(1.06); }

    .gift-icon {
        width: 50px;
    }

    .day-number {
        position: absolute;
        top: 5px;
        left: 8px;
        font-weight: bold;
        color: #b3001b;
    }

    /* POPUP + ANIMATION */
    #popup {
        display:none;
        position:fixed;
        top:0; left:0;
        width:100%; height:100%;
        background:rgba(0,0,0,0.7);
        justify-content:center;
        align-items:center;
        z-index: 9999;
    }

    #popup img {
        max-width: 420px;
        border-radius: 12px;
        animation: openMagic 0.7s ease-out;
    }

    @keyframes openMagic {
        0% { transform: scale(0.3) rotate(-10deg); opacity: 0; }
        60% { transform: scale(1.1) rotate(3deg); opacity: 1; }
        100% { transform: scale(1) rotate(0deg); }
    }

    #popup button {
        position:absolute;
        top:20px;
        right:20px;
        font-size: 26px;
        background:none;
        border:none;
        cursor:pointer;
        color:white;
    }

    /* MUSIQUE */
    #musicBtn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: #b3001b;
        color: white;
        border-radius: 40px;
        padding: 14px 25px;
        font-size: 18px;
        border: 2px solid #ddc98c;
        cursor: pointer;
        z-index: 999;
    }
</style>

</head>
<body>

<button id="modeToggle">üåô Mode Nuit</button>
<button id="musicBtn" onclick="toggleMusic()">üéµ Musique</button>

<div id="site-wrapper">

<nav>
    <button onclick="showTab('liste')">Liste de cadeaux</button>
    <button onclick="showTab('calendrier')">Calendrier de l'avent üéÑ</button>
</nav>

<div id="liste">
<h1>Liste de No√´l ‚Äì Pierre, Nathalya, Toffee & Topito üê∂üêæ</h1>
<h3 id="countdown"></h3>

<button id="addRowBtn">+ Ajouter un cadeau</button>

<table id="giftTable">
    <thead>
        <tr>
            <th>üéÅ Personne</th><th>üéÅ Cadeau</th><th>üí∞ Prix</th><th>üîó Lien</th><th>‚úî</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>
</div>

<!-- CALENDRIER -->
<div id="calendrier">
    <h2>üéÑ Calendrier de l'avent ‚Äì 2025</h2>

    <div class="calendrier-grid">
        <script>
            const today = new Date();
            const currentDay = (today.getMonth() === 11) ? today.getDate() : 0;

            for (let i = 1; i <= 24; i++) {
                const locked = (i === 1) ? "" : (i > currentDay ? "locked" : "");
                document.write(`
                    <div class="day ${locked}" onclick="openGift(${i})">
                        <span class="day-number">${i}</span>
                        <img src="https://cdn-icons-png.flaticon.com/512/4208/4208394.png"
                        class="gift-icon">
                    </div>
                `);
            }
        </script>
    </div>
</div>

</div>

<!-- POPUP -->
<div id="popup">
    <button onclick="closePopup()">‚úñ</button>
    <img id="popupImage" src="">
</div>

<!-- MUSIQUE -->
<audio id="music" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_4f400e82b5.mp3?filename=jingle-bells-110547.mp3" loop></audio>

<!-- SAPIN -->
<div id="tree">üéÑ</div>

<script>

/* ONGLET */
function showTab(tab) {
    document.getElementById("liste").style.display = "none";
    document.getElementById("calendrier").style.display = "none";
    document.getElementById(tab).style.display = "block";
}

/* IMAGES */
const images = {
    1:"images/toffee1.jpg",
    2:"images/topito1.jpg",
    3:"images/toffee2.jpg",
    4:"images/topito2.jpg",
    5:"images/toffee3.jpg",
    6:"images/topito3.jpg",
    7:"images/toffee4.jpg",
    8:"images/topito4.jpg",
    9:"images/toffee5.jpg",
    10:"images/topito5.jpg",
    11:"images/toffee6.jpg",
    12:"images/topito6.jpg",
    13:"images/toffee7.jpg",
    14:"images/topito7.jpg",
    15:"images/toffee8.jpg",
    16:"images/topito8.jpg",
    17:"images/toffee9.jpg",
    18:"images/topito9.jpg",
    19:"images/toffee10.jpg",
    20:"images/topito10.jpg",
    21:"images/toffee11.jpg",
    22:"images/topito11.jpg",
    23:"images/toffee12.jpg",
    24:"images/topito12.jpg"
};

/* OUVERTURE CADEAU */
function openGift(day){
    const today = new Date();
    const nowDay = (today.getMonth() === 11) ? today.getDate() : 0;

	if(day !== 1 && day > nowDay){
    		alert("Tu ne peux pas ouvrir cette case avant le " + day + " d√©cembre üéÑ");
    		return;
		}


    const img = images[day];
    if(!img){
        alert("Image non encore ajout√©e üê∂‚ú®");
        return;
    }

    document.getElementById("popupImage").src = img;
    document.getElementById("popup").style.display = "flex";
}

function closePopup(){
    document.getElementById("popup").style.display = "none";
}

/* MODE NUIT */
document.getElementById("modeToggle").onclick = () => {
    document.body.classList.toggle("night");
    document.getElementById("modeToggle").textContent =
        document.body.classList.contains("night") ? "‚òÄÔ∏è Mode Jour" : "üåô Mode Nuit";
};

/* MUSIQUE */
function toggleMusic(){
    const m = document.getElementById("music");
    const btn = document.getElementById("musicBtn");

    if(m.paused){
        m.play();
        btn.textContent = "üîá Stop musique";
    } else {
        m.pause();
        btn.textContent = "üéµ Musique";
    }
}

/* TABLEAU CADEAUX */
function createRow(data = {}) {
    const tbody = document.querySelector("#giftTable tbody");
    const row = document.createElement("tr");

    row.innerHTML = `
        <td><select><option>Pierre</option><option>Nathalya</option><option>Pierre & Nathalya</option><option>Toffee</option><option>Topito</option></select></td>
        <td contenteditable="true">${data.cadeau || ""}</td>
        <td contenteditable="true">${data.prix || ""}</td>
        <td>
            <input class="linkInput" value="${data.lien || ""}" placeholder="Coller un lien">
            <div class="linkDisplay"></div>
        </td>
        <td><input type="checkbox" ${data.checked ? "checked" : ""}></td>
    `;

    const checkbox = row.querySelector("input[type='checkbox']");
    checkbox.onchange = () => {
        row.classList.toggle("selected", checkbox.checked);
        saveTable();
    };

    const linkInput = row.querySelector(".linkInput");
    const linkDisplay = row.querySelector(".linkDisplay");

    function updateLink(url){
        linkDisplay.innerHTML = `<a class="kdo-link" href="${url}" target="_blank">Voir</a>
        <button class="editLinkBtn">Modifier</button>`;
    }

    linkInput.addEventListener("keydown", e => {
        if(e.key === "Enter"){
            const url = linkInput.value.trim();
            if(url){
                updateLink(url);
                linkInput.style.display="none";
                saveTable();
            }
        }
    });

    linkDisplay.onclick = e => {
        if(e.target.classList.contains("editLinkBtn")){
            linkInput.style.display="block";
        }
    };

    if(data.lien){
        updateLink(data.lien);
        linkInput.style.display="none";
    }

    tbody.appendChild(row);
}

document.getElementById("addRowBtn").onclick = () => { createRow(); saveTable(); };

function saveTable() {
    const list = [];
    document.querySelectorAll("#giftTable tbody tr").forEach(tr => {
        list.push({
            cadeau: tr.children[1].innerText,
            prix: tr.children[2].innerText,
            lien: tr.querySelector(".linkInput").value,
            checked: tr.querySelector("input[type=checkbox]").checked
        });
    });
    localStorage.setItem("giftList", JSON.stringify(list));
}

(function load(){
    const saved = JSON.parse(localStorage.getItem("giftList") || "[]");
    saved.forEach(r => createRow(r));
})();

/* NEIGE */
for (let i = 0; i < 60; i++) {
    const f = document.createElement("div");
    f.className = "flake";
    f.textContent = "‚ùÑ";
    f.style.left = Math.random()*100+"vw";
    f.style.fontSize = 10 + Math.random()*25 + "px";
    f.style.animationDuration = 5 + Math.random()*12 + "s";
    f.style.animationDelay = Math.random()*5 + "s";
    document.body.appendChild(f);
}

</script>

</body>
</html>

